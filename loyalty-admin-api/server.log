
> loyalty-admin-api@1.0.0 start
> node server.js

[dotenv@17.0.1] injecting env (13) from .env â€“ [tip] encrypt with dotenvx: https://dotenvx.com
[dotenv@17.0.1] injecting env (0) from .env â€“ [tip] encrypt with dotenvx: https://dotenvx.com
ðŸ”„ Initializing database...
Executing (default): SELECT 1+1 AS result
Executing (default): SELECT 1+1 AS result
âœ… Database connection established.
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='business';
âœ… Database connection established successfully.
Executing (default): PRAGMA INDEX_LIST(`business`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_business_1`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='admins';
Executing (default): PRAGMA INDEX_LIST(`admins`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_admins_1`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='themes';
Executing (default): PRAGMA INDEX_LIST(`themes`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='rankings';
Executing (default): PRAGMA INDEX_LIST(`rankings`)
Executing (default): PRAGMA INDEX_INFO(`rankings_business_id_level`)
Executing (default): PRAGMA INDEX_INFO(`rankings_business_id`)
Executing (default): PRAGMA INDEX_INFO(`rankings_points_required`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='coupons';
Executing (default): PRAGMA INDEX_LIST(`coupons`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_coupons_1`)
Executing (default): PRAGMA INDEX_INFO(`coupons_business_id_code`)
Executing (default): PRAGMA INDEX_INFO(`coupons_business_id`)
Executing (default): PRAGMA INDEX_INFO(`coupons_is_active`)
Executing (default): PRAGMA INDEX_INFO(`coupons_expiration_date`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='superadmins';
Executing (default): PRAGMA INDEX_LIST(`superadmins`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_superadmins_1`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='point_tiers';
Executing (default): PRAGMA INDEX_LIST(`point_tiers`)
Executing (default): PRAGMA INDEX_INFO(`point_tiers_business_id_tier_level`)
Executing (default): PRAGMA INDEX_INFO(`point_tiers_business_id`)
Executing (default): PRAGMA INDEX_INFO(`point_tiers_points_required`)
Executing (default): PRAGMA INDEX_INFO(`point_tiers_sort_order`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='users';
Executing (default): PRAGMA INDEX_LIST(`users`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_users_1`)
Executing (default): PRAGMA INDEX_INFO(`users_email`)
Executing (default): PRAGMA INDEX_INFO(`users_phone_number`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='user_businesses';
Executing (default): PRAGMA INDEX_LIST(`user_businesses`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_user_businesses_1`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_user_id_business_id`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_business_id_member_id`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_user_id`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_business_id`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_member_id`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_total_points`)
Executing (default): PRAGMA INDEX_INFO(`user_businesses_current_ranking_id`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='transactions';
Executing (default): PRAGMA INDEX_LIST(`transactions`)
Executing (default): PRAGMA INDEX_INFO(`sqlite_autoindex_transactions_1`)
Executing (default): PRAGMA INDEX_INFO(`transactions_business_id`)
Executing (default): PRAGMA INDEX_INFO(`transactions_user_id`)
Executing (default): PRAGMA INDEX_INFO(`transactions_transaction_id`)
Executing (default): PRAGMA INDEX_INFO(`transactions_status`)
Executing (default): PRAGMA INDEX_INFO(`transactions_transaction_date`)
Executing (default): PRAGMA INDEX_INFO(`transactions_business_id_user_id`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='points_transactions';
Executing (default): PRAGMA INDEX_LIST(`points_transactions`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_business_id`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_user_id`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_transaction_id`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_type`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_reference_id_reference_type`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_created_at`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_expires_at`)
Executing (default): PRAGMA INDEX_INFO(`points_transactions_business_id_user_id_created_at`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='rewards';
Executing (default): PRAGMA INDEX_LIST(`rewards`)
Executing (default): PRAGMA INDEX_INFO(`rewards_business_id`)
Executing (default): PRAGMA INDEX_INFO(`rewards_points_cost`)
Executing (default): PRAGMA INDEX_INFO(`rewards_type`)
Executing (default): PRAGMA INDEX_INFO(`rewards_is_active`)
Executing (default): PRAGMA INDEX_INFO(`rewards_is_featured`)
Executing (default): PRAGMA INDEX_INFO(`rewards_valid_from_valid_until`)
Executing (default): PRAGMA INDEX_INFO(`rewards_business_id_is_active_sort_order`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='user_point_tiers';
Executing (default): PRAGMA INDEX_LIST(`user_point_tiers`)
Executing (default): PRAGMA INDEX_INFO(`user_point_tiers_business_id_user_id`)
Executing (default): PRAGMA INDEX_INFO(`user_point_tiers_business_id`)
Executing (default): PRAGMA INDEX_INFO(`user_point_tiers_user_id`)
Executing (default): PRAGMA INDEX_INFO(`user_point_tiers_current_tier_id`)
Executing (default): PRAGMA INDEX_INFO(`user_point_tiers_tier_points`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='menu_items';
Executing (default): PRAGMA INDEX_LIST(`menu_items`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_business_id`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_category`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_is_available`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_is_active`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_sort_order`)
Executing (default): PRAGMA INDEX_INFO(`menu_items_business_id_category`)
Executing (default): SELECT name FROM sqlite_master WHERE type='table' AND name='menu_item_purchases';
Executing (default): PRAGMA INDEX_LIST(`menu_item_purchases`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_business_id`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_user_id`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_menu_item_id`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_status`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_purchase_date`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_business_id_user_id`)
Executing (default): PRAGMA INDEX_INFO(`menu_item_purchases_business_id_purchase_date`)
âœ… Database tables synchronized.
Executing (default): SELECT count(*) AS `count` FROM `admins` AS `Admin`;
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` LIMIT 1;
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` LIMIT 1;
Executing (default): SELECT count(*) AS `count` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1;
Executing (default): SELECT count(*) AS `count` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1;
Executing (default): SELECT count(*) AS `count` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1;
Executing (default): SELECT count(*) AS `count` FROM `superadmins` AS `SuperAdmin`;
ðŸŽ‰ Database initialization completed successfully!
ðŸš€ Server running on port 3001
ðŸ“± Loyalty Admin API ready
ðŸ”— Health check: http://localhost:3001/health
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 1;
Getting business memberships for user: 1
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 1,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000001',
    joinDate: 2025-07-10T05:01:28.186Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T05:01:28.208Z,
    isActive: true
  }
]
::1 - - [10/Jul/2025:05:04:03 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "curl/8.7.1"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `password`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`email` = '384328@gmail.com';
Executing (default): INSERT INTO `users` (`id`,`first_name`,`last_name`,`email`,`password`,`phone_number`,`is_active`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8);
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:28 +0000] "POST /api/users/register HTTP/1.1" 201 382 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Getting business memberships for user: 2
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:28 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:28 +0000] "GET /api/users/profile HTTP/1.1" 200 307 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:33 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:36 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Join business request: { businessCode: 'DEMO1', userId: 2 }
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Found business: 1
Executing (default): SELECT `id`, `user_id` AS `userId`, `business_id` AS `businessId`, `member_id` AS `memberId`, `join_date` AS `joinDate`, `total_points` AS `totalPoints`, `available_points` AS `availablePoints`, `lifetime_points` AS `lifetimePoints`, `current_ranking_id` AS `currentRankingId`, `last_activity` AS `lastActivity`, `is_active` AS `isActive`, `preferences`, `created_at`, `updated_at` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`user_id` = 2 AND `UserBusiness`.`business_id` = 1 LIMIT 1;
Existing membership: None
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `pointsRequired` ASC LIMIT 1;
Initial ranking: 1
Executing (default): SELECT count(*) AS `count` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`business_id` = 1;
Creating membership with: {
  userId: 2,
  businessId: 1,
  currentRankingId: 1,
  memberId: 'DEMO1000002'
}
UserBusiness beforeCreate hook triggered
Executing (default): INSERT INTO `user_businesses` (`id`,`user_id`,`business_id`,`member_id`,`join_date`,`total_points`,`available_points`,`lifetime_points`,`current_ranking_id`,`is_active`,`preferences`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12);
Membership created: 2
Executing (default): INSERT INTO `points_transactions` (`id`,`business_id`,`user_id`,`type`,`points`,`description`,`reference_id`,`reference_type`,`balance_before`,`balance_after`,`multiplier`,`metadata`,`is_reversed`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14);
Executing (default): UPDATE `user_businesses` SET `total_points`=$1,`available_points`=$2,`lifetime_points`=$3,`last_activity`=$4,`updated_at`=$5 WHERE `id` = $6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`id` = 2;
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:36 +0000] "POST /api/users/join-business HTTP/1.1" 201 330 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:36 +0000] "GET /api/users/profile HTTP/1.1" 200 1747 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:36 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Getting business memberships for user: 2
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
Found memberships: 1
Formatted memberships: [
  {
    id: 2,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000002',
    joinDate: 2025-07-10T05:04:36.645Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T05:04:36.660Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:38 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:38 +0000] "GET /api/users/profile HTTP/1.1" 200 1747 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Getting business memberships for user: 2
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
Found memberships: 1
Formatted memberships: [
  {
    id: 2,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000002',
    joinDate: 2025-07-10T05:04:36.645Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T05:04:36.660Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:43 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:05:04:43 +0000] "GET /api/users/profile HTTP/1.1" 200 1747 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:07:09 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Getting business memberships for user: 2
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
Found memberships: 1
Formatted memberships: [
  {
    id: 2,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000002',
    joinDate: 2025-07-10T05:04:36.645Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T05:04:36.660Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:05:10:14 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:05:10:14 +0000] "GET /api/users/profile HTTP/1.1" 200 1747 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:10:16 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:05:13:55 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 2;
Getting business memberships for user: 2
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 2;
Found memberships: 1
Formatted memberships: [
  {
    id: 2,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000002',
    joinDate: 2025-07-10T05:04:36.645Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T05:04:36.660Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:05:13:59 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:05:13:59 +0000] "GET /api/users/profile HTTP/1.1" 200 1747 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `password`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`email` = 'wpirpo@gmail.com';
Executing (default): INSERT INTO `users` (`id`,`first_name`,`last_name`,`email`,`password`,`phone_number`,`is_active`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8);
::ffff:127.0.0.1 - - [10/Jul/2025:09:18:15 +0000] "POST /api/users/register HTTP/1.1" 201 388 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:18:15 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:09:18:15 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:18:31 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:18:31 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:26:02 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:26:03 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:26:06 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:09:26:06 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:29:39 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:29:39 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:09:44:08 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:09:44:08 +0000] "GET /api/users/profile HTTP/1.1" 200 313 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:39 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:42 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Join business request: { businessCode: 'DEMO1', userId: 3 }
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Found business: 1
Executing (default): SELECT `id`, `user_id` AS `userId`, `business_id` AS `businessId`, `member_id` AS `memberId`, `join_date` AS `joinDate`, `total_points` AS `totalPoints`, `available_points` AS `availablePoints`, `lifetime_points` AS `lifetimePoints`, `current_ranking_id` AS `currentRankingId`, `last_activity` AS `lastActivity`, `is_active` AS `isActive`, `preferences`, `created_at`, `updated_at` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`user_id` = 3 AND `UserBusiness`.`business_id` = 1 LIMIT 1;
Existing membership: None
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `pointsRequired` ASC LIMIT 1;
Initial ranking: 1
Executing (default): SELECT count(*) AS `count` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`business_id` = 1;
Creating membership with: {
  userId: 3,
  businessId: 1,
  currentRankingId: 1,
  memberId: 'DEMO1000003'
}
UserBusiness beforeCreate hook triggered
Executing (default): INSERT INTO `user_businesses` (`id`,`user_id`,`business_id`,`member_id`,`join_date`,`total_points`,`available_points`,`lifetime_points`,`current_ranking_id`,`is_active`,`preferences`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12);
Membership created: 3
Executing (default): INSERT INTO `points_transactions` (`id`,`business_id`,`user_id`,`type`,`points`,`description`,`reference_id`,`reference_type`,`balance_before`,`balance_after`,`multiplier`,`metadata`,`is_reversed`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14);
Executing (default): UPDATE `user_businesses` SET `total_points`=$1,`available_points`=$2,`lifetime_points`=$3,`last_activity`=$4,`updated_at`=$5 WHERE `id` = $6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:42 +0000] "POST /api/users/join-business HTTP/1.1" 201 330 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:42 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:43 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:50 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:50 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:54 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:54 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:57 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:09:46:57 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:10:04:26 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:10:04:26 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:10:12:09 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:10:12:09 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:10:19:26 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:10:19:26 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:11:43:27 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:11:44:02 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:11:44:02 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:12:38:21 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:12:38:21 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:12:38:23 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:12:38:23 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:35:13 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:16:35:13 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:16:38:06 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:38:06 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:16:38:08 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:38:08 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:39:15 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:16:39:15 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:41:17 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:41:17 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:41:42 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:41:42 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:42:10 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:42:10 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:42:17 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:42:17 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:45:02 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
::ffff:127.0.0.1 - - [10/Jul/2025:16:45:02 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:45:14 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:45:14 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:47:55 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:47:55 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 3;
Getting business memberships for user: 3
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 3;
Found memberships: 1
Formatted memberships: [
  {
    id: 3,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000003',
    joinDate: 2025-07-10T09:46:42.934Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T09:46:42.942Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:47:58 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:47:58 +0000] "GET /api/users/profile HTTP/1.1" 200 1753 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `password`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`email` = '234@gmail.com';
Executing (default): INSERT INTO `users` (`id`,`first_name`,`last_name`,`email`,`password`,`phone_number`,`is_active`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8);
::ffff:127.0.0.1 - - [10/Jul/2025:16:48:40 +0000] "POST /api/users/register HTTP/1.1" 201 379 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:16:48:40 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
::ffff:127.0.0.1 - - [10/Jul/2025:16:48:40 +0000] "GET /api/users/profile HTTP/1.1" 200 308 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4;
::ffff:127.0.0.1 - - [10/Jul/2025:16:48:44 +0000] "GET /api/users/profile HTTP/1.1" 200 308 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:16:48:44 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:16:52:48 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:16:56:33 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:31 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:34 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Join business request: { businessCode: 'DEMO1', userId: 4 }
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Found business: 1
Executing (default): SELECT `id`, `user_id` AS `userId`, `business_id` AS `businessId`, `member_id` AS `memberId`, `join_date` AS `joinDate`, `total_points` AS `totalPoints`, `available_points` AS `availablePoints`, `lifetime_points` AS `lifetimePoints`, `current_ranking_id` AS `currentRankingId`, `last_activity` AS `lastActivity`, `is_active` AS `isActive`, `preferences`, `created_at`, `updated_at` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`user_id` = 4 AND `UserBusiness`.`business_id` = 1 LIMIT 1;
Existing membership: None
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `pointsRequired` ASC LIMIT 1;
Initial ranking: 1
Executing (default): SELECT count(*) AS `count` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`business_id` = 1;
Creating membership with: {
  userId: 4,
  businessId: 1,
  currentRankingId: 1,
  memberId: 'DEMO1000004'
}
UserBusiness beforeCreate hook triggered
Executing (default): INSERT INTO `user_businesses` (`id`,`user_id`,`business_id`,`member_id`,`join_date`,`total_points`,`available_points`,`lifetime_points`,`current_ranking_id`,`is_active`,`preferences`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12);
Membership created: 4
Executing (default): INSERT INTO `points_transactions` (`id`,`business_id`,`user_id`,`type`,`points`,`description`,`reference_id`,`reference_type`,`balance_before`,`balance_after`,`multiplier`,`metadata`,`is_reversed`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14);
Executing (default): UPDATE `user_businesses` SET `total_points`=$1,`available_points`=$2,`lifetime_points`=$3,`last_activity`=$4,`updated_at`=$5 WHERE `id` = $6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`id` = 4;
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:34 +0000] "POST /api/users/join-business HTTP/1.1" 201 330 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4;
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:34 +0000] "GET /api/users/profile HTTP/1.1" 200 1748 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:35 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:36 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:45 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:47 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:49 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:16:57:51 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
::1 - - [10/Jul/2025:21:01:41 +0000] "GET /api/auth/verify HTTP/1.1" 401 51 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
::1 - - [10/Jul/2025:21:01:41 +0000] "GET /api/auth/verify HTTP/1.1" 401 51 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`email` = 'admin@yourbusiness.com' AND `Admin`.`is_active` = 1;
Executing (default): UPDATE `admins` SET `last_login`=$1,`updated_at`=$2 WHERE `id` = $3
::1 - - [10/Jul/2025:21:01:43 +0000] "POST /api/auth/login HTTP/1.1" 200 399 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 ORDER BY `Theme`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
::1 - - [10/Jul/2025:21:01:45 +0000] "GET /api/theme/presets HTTP/1.1" 200 1683 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
::1 - - [10/Jul/2025:21:01:45 +0000] "GET /api/theme/colors HTTP/1.1" 200 632 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 ORDER BY `Theme`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
::1 - - [10/Jul/2025:21:01:45 +0000] "GET /api/theme/presets HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
::1 - - [10/Jul/2025:21:01:45 +0000] "GET /api/theme/colors HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
::1 - - [10/Jul/2025:21:01:47 +0000] "GET /api/rankings HTTP/1.1" 200 1002 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
::1 - - [10/Jul/2025:21:01:47 +0000] "GET /api/rankings HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:01:47 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 200 2216 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:01:47 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 ORDER BY `Theme`.`created_at` DESC;
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/theme/colors HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/theme/presets HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 ORDER BY `Theme`.`created_at` DESC;
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/theme/colors HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/theme/presets HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:03:35 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:06:08 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:07:54 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:07:56 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:07:59 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:08:03 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:08:05 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 4;
Getting business memberships for user: 4
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 4 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 4,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000004',
    joinDate: 2025-07-10T16:57:34.854Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T16:57:34.862Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:09:03 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `password`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`email` = 'samjoe@gmail.com';
Executing (default): INSERT INTO `users` (`id`,`first_name`,`last_name`,`email`,`password`,`phone_number`,`is_active`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8);
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:21 +0000] "POST /api/users/register HTTP/1.1" 201 379 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:21 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 0
Formatted memberships: []
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:23 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 82 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:29 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:54 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Join business request: { businessCode: 'DEMO1', userId: 5 }
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Found business: 1
Executing (default): SELECT `id`, `user_id` AS `userId`, `business_id` AS `businessId`, `member_id` AS `memberId`, `join_date` AS `joinDate`, `total_points` AS `totalPoints`, `available_points` AS `availablePoints`, `lifetime_points` AS `lifetimePoints`, `current_ranking_id` AS `currentRankingId`, `last_activity` AS `lastActivity`, `is_active` AS `isActive`, `preferences`, `created_at`, `updated_at` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`user_id` = 5 AND `UserBusiness`.`business_id` = 1 LIMIT 1;
Existing membership: None
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `pointsRequired` ASC LIMIT 1;
Initial ranking: 1
Executing (default): SELECT count(*) AS `count` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`business_id` = 1;
Creating membership with: {
  userId: 5,
  businessId: 1,
  currentRankingId: 1,
  memberId: 'DEMO1000005'
}
UserBusiness beforeCreate hook triggered
Executing (default): INSERT INTO `user_businesses` (`id`,`user_id`,`business_id`,`member_id`,`join_date`,`total_points`,`available_points`,`lifetime_points`,`current_ranking_id`,`is_active`,`preferences`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12);
Membership created: 5
Executing (default): INSERT INTO `points_transactions` (`id`,`business_id`,`user_id`,`type`,`points`,`description`,`reference_id`,`reference_type`,`balance_before`,`balance_after`,`multiplier`,`metadata`,`is_reversed`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14);
Executing (default): UPDATE `user_businesses` SET `total_points`=$1,`available_points`=$2,`lifetime_points`=$3,`last_activity`=$4,`updated_at`=$5 WHERE `id` = $6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`id` = 5;
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:54 +0000] "POST /api/users/join-business HTTP/1.1" 201 330 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`logo_url` AS `business.logoUrl`, `business`.`contact_email` AS `business.contactEmail`, `business`.`contact_phone` AS `business.contactPhone`, `business`.`address` AS `business.address`, `business`.`operating_hours` AS `business.operatingHours`, `business`.`category` AS `business.category`, `business`.`website` AS `business.website`, `business`.`established` AS `business.established`, `business`.`member_since` AS `business.memberSince`, `business`.`total_members` AS `business.totalMembers`, `business`.`features` AS `business.features`, `business`.`social_media` AS `business.socialMedia`, `business`.`loyalty_benefits` AS `business.loyaltyBenefits`, `business`.`created_at` AS `business.created_at`, `business`.`updated_at` AS `business.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`business_id` AS `currentRanking.businessId`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`points_required` AS `currentRanking.pointsRequired`, `currentRanking`.`benefits` AS `currentRanking.benefits`, `currentRanking`.`color` AS `currentRanking.color`, `currentRanking`.`icon_url` AS `currentRanking.iconUrl`, `currentRanking`.`created_at` AS `currentRanking.created_at`, `currentRanking`.`updated_at` AS `currentRanking.updated_at` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5;
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:54 +0000] "GET /api/users/profile HTTP/1.1" 200 1744 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:10:54 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 5,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000005',
    joinDate: 2025-07-10T21:10:54.204Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T21:10:54.210Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:16:42 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:16:44 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 5,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000005',
    joinDate: 2025-07-10T21:10:54.204Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T21:10:54.210Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:18:45 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:18:47 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 5,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000005',
    joinDate: 2025-07-10T21:10:54.204Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T21:10:54.210Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:21:21 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:21:23 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 5;
Getting business memberships for user: 5
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 5 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 5,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000005',
    joinDate: 2025-07-10T21:10:54.204Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T21:10:54.210Z,
    isActive: true
  }
]
::ffff:127.0.0.1 - - [10/Jul/2025:21:23:00 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Executing (default): SELECT `id`, `business_id` AS `businessId`, `name`, `colors`, `is_active` AS `isActive`, `created_at`, `updated_at` FROM `themes` AS `Theme` WHERE `Theme`.`business_id` = 1 AND `Theme`.`is_active` = 1 LIMIT 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `Ranking`.`level` ASC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `title`, `description`, `code`, `discount_type` AS `discountType`, `discount_value` AS `discountValue`, `minimum_purchase` AS `minimumPurchase`, `expiration_date` AS `expirationDate`, `usage_limit` AS `usageLimit`, `used_count` AS `usedCount`, `is_active` AS `isActive`, `target_ranking_level` AS `targetRankingLevel`, `created_at`, `updated_at` FROM `coupons` AS `Coupon` WHERE `Coupon`.`business_id` = 1 AND `Coupon`.`is_active` = 1 ORDER BY `Coupon`.`created_at` DESC;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `tier_level` AS `tierLevel`, `name`, `points_required` AS `pointsRequired`, `description`, `rewards`, `color`, `icon_url` AS `iconUrl`, `is_active` AS `isActive`, `sort_order` AS `sortOrder`, `created_at`, `updated_at` FROM `point_tiers` AS `PointTier` WHERE `PointTier`.`business_id` = 1 AND `PointTier`.`is_active` = 1 ORDER BY `tierLevel` ASC;
::ffff:127.0.0.1 - - [10/Jul/2025:21:23:02 +0000] "GET /api/public/business/DEMO1 HTTP/1.1" 200 2560 "-" "Dart/3.8 (dart:io)"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1;
::1 - - [10/Jul/2025:21:41:39 +0000] "GET /api/auth/verify HTTP/1.1" 200 158 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1;
::1 - - [10/Jul/2025:21:41:39 +0000] "GET /api/auth/verify HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:41:42 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 200 2734 "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:41:42 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `password`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`email` = 'john.doe.test@example.com';
Executing (default): INSERT INTO `users` (`id`,`first_name`,`last_name`,`email`,`password`,`is_active`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7);
::1 - - [10/Jul/2025:21:42:18 +0000] "POST /api/users/register HTTP/1.1" 201 372 "-" "curl/8.7.1"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1;
::1 - - [10/Jul/2025:21:42:30 +0000] "GET /api/auth/verify HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1;
::1 - - [10/Jul/2025:21:42:30 +0000] "GET /api/auth/verify HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:42:30 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `business_id` AS `businessId`, `email`, `password`, `first_name` AS `firstName`, `last_name` AS `lastName`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `admins` AS `Admin` WHERE `Admin`.`id` = 1 AND `Admin`.`is_active` = 1;
Executing (default): SELECT count(`UserBusiness`.`id`) AS `count` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1;
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `user`.`id` AS `user.id`, `user`.`first_name` AS `user.firstName`, `user`.`last_name` AS `user.lastName`, `user`.`email` AS `user.email`, `user`.`phone_number` AS `user.phoneNumber`, `user`.`date_of_birth` AS `user.dateOfBirth`, `user`.`profile_image_url` AS `user.profileImageUrl`, `user`.`is_active` AS `user.isActive`, `user`.`last_login` AS `user.lastLogin`, `user`.`created_at` AS `user.created_at`, `user`.`updated_at` AS `user.updated_at`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` INNER JOIN `users` AS `user` ON `UserBusiness`.`user_id` = `user`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`business_id` = 1 ORDER BY `UserBusiness`.`created_at` DESC LIMIT 0, 20;
::1 - - [10/Jul/2025:21:42:30 +0000] "GET /api/admin/users?page=1&limit=20&search=&sortBy=joinDate&sortOrder=desc HTTP/1.1" 304 - "http://localhost:3000/" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 6;
Join business request: { businessCode: 'DEMO1', userId: 6 }
Executing (default): SELECT `id`, `name`, `business_code` AS `businessCode`, `description`, `logo_url` AS `logoUrl`, `contact_email` AS `contactEmail`, `contact_phone` AS `contactPhone`, `address`, `operating_hours` AS `operatingHours`, `category`, `website`, `established`, `member_since` AS `memberSince`, `total_members` AS `totalMembers`, `features`, `social_media` AS `socialMedia`, `loyalty_benefits` AS `loyaltyBenefits`, `created_at`, `updated_at` FROM `business` AS `Business` WHERE `Business`.`business_code` = 'DEMO1';
Found business: 1
Executing (default): SELECT `id`, `user_id` AS `userId`, `business_id` AS `businessId`, `member_id` AS `memberId`, `join_date` AS `joinDate`, `total_points` AS `totalPoints`, `available_points` AS `availablePoints`, `lifetime_points` AS `lifetimePoints`, `current_ranking_id` AS `currentRankingId`, `last_activity` AS `lastActivity`, `is_active` AS `isActive`, `preferences`, `created_at`, `updated_at` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`user_id` = 6 AND `UserBusiness`.`business_id` = 1 LIMIT 1;
Existing membership: None
Executing (default): SELECT `id`, `business_id` AS `businessId`, `level`, `title`, `points_required` AS `pointsRequired`, `benefits`, `color`, `icon_url` AS `iconUrl`, `created_at`, `updated_at` FROM `rankings` AS `Ranking` WHERE `Ranking`.`business_id` = 1 ORDER BY `pointsRequired` ASC LIMIT 1;
Initial ranking: 1
Executing (default): SELECT count(*) AS `count` FROM `user_businesses` AS `UserBusiness` WHERE `UserBusiness`.`business_id` = 1;
Creating membership with: {
  userId: 6,
  businessId: 1,
  currentRankingId: 1,
  memberId: 'DEMO1000006'
}
UserBusiness beforeCreate hook triggered
Executing (default): INSERT INTO `user_businesses` (`id`,`user_id`,`business_id`,`member_id`,`join_date`,`total_points`,`available_points`,`lifetime_points`,`current_ranking_id`,`is_active`,`preferences`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12);
Membership created: 6
Executing (default): INSERT INTO `points_transactions` (`id`,`business_id`,`user_id`,`type`,`points`,`description`,`reference_id`,`reference_type`,`balance_before`,`balance_after`,`multiplier`,`metadata`,`is_reversed`,`created_at`,`updated_at`) VALUES (NULL,$1,$2,$3,$4,$5,$6,$7,$8,$9,$10,$11,$12,$13,$14);
Executing (default): UPDATE `user_businesses` SET `total_points`=$1,`available_points`=$2,`lifetime_points`=$3,`last_activity`=$4,`updated_at`=$5 WHERE `id` = $6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`level` AS `currentRanking.level`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`id` = 6;
::1 - - [10/Jul/2025:21:42:40 +0000] "POST /api/users/join-business HTTP/1.1" 201 330 "-" "curl/8.7.1"
Executing (default): SELECT `id`, `first_name` AS `firstName`, `last_name` AS `lastName`, `email`, `phone_number` AS `phoneNumber`, `date_of_birth` AS `dateOfBirth`, `profile_image_url` AS `profileImageUrl`, `is_active` AS `isActive`, `last_login` AS `lastLogin`, `created_at`, `updated_at` FROM `users` AS `User` WHERE `User`.`id` = 6;
Getting business memberships for user: 6
Executing (default): SELECT `UserBusiness`.`id`, `UserBusiness`.`user_id` AS `userId`, `UserBusiness`.`business_id` AS `businessId`, `UserBusiness`.`member_id` AS `memberId`, `UserBusiness`.`join_date` AS `joinDate`, `UserBusiness`.`total_points` AS `totalPoints`, `UserBusiness`.`available_points` AS `availablePoints`, `UserBusiness`.`lifetime_points` AS `lifetimePoints`, `UserBusiness`.`current_ranking_id` AS `currentRankingId`, `UserBusiness`.`last_activity` AS `lastActivity`, `UserBusiness`.`is_active` AS `isActive`, `UserBusiness`.`preferences`, `UserBusiness`.`created_at`, `UserBusiness`.`updated_at`, `business`.`id` AS `business.id`, `business`.`name` AS `business.name`, `business`.`business_code` AS `business.businessCode`, `business`.`description` AS `business.description`, `business`.`category` AS `business.category`, `currentRanking`.`id` AS `currentRanking.id`, `currentRanking`.`title` AS `currentRanking.title`, `currentRanking`.`color` AS `currentRanking.color` FROM `user_businesses` AS `UserBusiness` LEFT OUTER JOIN `business` AS `business` ON `UserBusiness`.`business_id` = `business`.`id` LEFT OUTER JOIN `rankings` AS `currentRanking` ON `UserBusiness`.`current_ranking_id` = `currentRanking`.`id` WHERE `UserBusiness`.`user_id` = 6 ORDER BY `UserBusiness`.`created_at` DESC;
Found memberships: 1
Formatted memberships: [
  {
    id: 6,
    businessId: 1,
    businessName: 'Demo Business',
    businessCode: 'DEMO1',
    businessDescription: 'This is a demo business for testing. Change this in the admin panel.',
    businessCategory: '',
    memberId: 'DEMO1000006',
    joinDate: 2025-07-10T21:42:40.309Z,
    totalPoints: 100,
    availablePoints: 100,
    lifetimePoints: 100,
    currentRanking: 'Bronze Explorer',
    currentRankingColor: '#CD7F32',
    lastActivity: 2025-07-10T21:42:40.324Z,
    isActive: true
  }
]
::1 - - [10/Jul/2025:21:42:52 +0000] "GET /api/users/business-memberships HTTP/1.1" 200 523 "-" "curl/8.7.1"
